var baseUrl="https://api.dobell.me/registration";var reg=/^1[345789]\d{9}$/;function GetRequest(){var e=decodeURI(location.search);var a=new Object;if(e.indexOf("?")!=-1){var t=e.substr(1);strs=t.split("&");for(var s=0;s<strs.length;s++){a[strs[s].split("=")[0]]=unescape(strs[s].split("=")[1])}}return a}var param=GetRequest();var arr=Object.keys(param);if(param.openId){if(!localStorage.state){const e={openId:param.openId};$.ajax({method:"POST",url:baseUrl+"/business/getPhoneByOpenId",async:false,cache:false,data:e,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){if(e.data!==null){sessionStorage.fromPhone=e.data;$("#r-redpack").fadeIn(2e3).css({display:"block"});$("#redbutton").click(function(){var e=$("#red-phone").val();if(reg.test(e)){const a={openId:param.openId,phone:e};$.ajax({method:"POST",url:baseUrl+"/business/addPacket",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){$("#r-redpack").css({display:"none"});if(e.code==-1){alert(e.message)}else{alert("红包领取成功")}},error:function(){alert("获取数据错误！")}})}else{$.toast.prototype.defaults.duration=1e3;$.toast("请输入正确的手机号","forbidden")}})}else{alert("错误的分享链接")}},error:function(){alert("获取数据错误！")}})}localStorage.clear();$(".box").click(function(){window.location.reload();window.location.reload();localStorage.state=1});$(".btn1").click(function(){signup()});var signup=function(){$(".signUp").fadeIn("slow").css({display:"block"});$.ajax({method:"GET",url:baseUrl+"/business/getClassList",async:true,cache:false,data:"",dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){const a=e.data[0].licenseType+" 手动 "+e.data[0].classType;const t=e.data[1].licenseType+" 手动 "+e.data[1].classType;const s=e.data[2].licenseType+" 手动 "+e.data[2].classType;const o=e.data[3].licenseType+" 自动 "+e.data[3].classType;$("#schclass1").text(a);$("#schclass2").text(t);$("#schclass3").text(s);$("#schclass4").text(o);var r=$("#select_id").find("option:selected").text();var c=$("#select_id").find("option:selected").val();$("#classmessage").text(r);$("#price").text(e.data[c].price);$("#exetime").text(e.data[c].teachTime);$("#select_id").change(function(){var a=$("#select_id").find("option:selected").text();var t=$("#select_id").find("option:selected").val();$("#classmessage").text(a);$("#price").text(e.data[t].price);$("#exetime").text(e.data[t].teachTime)})},error:function(){alert("加载失败")}});$("#phone").blur(function(){$("#select-redpack").empty();var e=$("#phone").val();if(reg.test(e)){var a={phone:e};$.ajax({method:"POST",url:baseUrl+"/business/getPacketList",async:false,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){localStorage.redpacklength=e.data.length;var a=[];for(let t=0;t<e.data.length;t++){a.push(e.data[t].id)}localStorage.localPacID=a.join(",")},error:function(){alert("获取红包数据错误！")}});if(localStorage.redpacklength>0){for(let e=0;e<localStorage.redpacklength;e++){$("#select-redpack").append("<option value="+(e+1)+">分享立减红包50元</option>")}}else{$("#select-redpack").append("<option value='0'>暂无红包信息</option>")}}else{$.toast.prototype.defaults.duration=1e3;$.toast("你输入的号码格式有误！","forbidden")}});$("#signUpBtn").click(function(){var e=$("#phone").val();var a=$("#realName").val();var t=$("#idCard").val();if(e&&a&&t){var s=parseInt($("#select_id").find("option:selected").val())+1;var o=e;var r;var c;var n=a;var l=t;if(sessionStorage.fromPhone){r=param.openId}else{r=""}if(parseInt($("#select-redpack").find("option:selected").val())==0){c=""}else{var i=parseInt($("#select-redpack").find("option:selected").val())-1;var d=localStorage.localPacID.split(",");c=parseInt(d[i])}if(IdCodeValid(l).pass==true){signUpMessage(s,o,r,c,n,l)}else{$.toast("身份证信息填写错误！","forbidden")}}else{$.toast("请完善报名信息！","forbidden")}})};var signUpMessage=function(e,a,t,s,o,r){var c={classId:e,phone:a,openId:t,packetId:s,realName:o,idCode:r};$.ajax({method:"POST",url:baseUrl+"/business/addOrder",async:true,cache:false,data:c,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){if(e.message==null){$(".signUp").css({display:"none"});$(".signUpSuccess").fadeIn("slow").css({display:"block"});getOrder(a)}else{alert(e.message)}},error:function(){alert("报名失败，请重试！")}})};var getOrder=function(e){var a={phone:e};$.ajax({method:"POST",url:baseUrl+"/business/getOrderByPhone",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){var a=e.data.orderNo;var t=e.data.price;var s=e.data.payPrice;var o=e.data.classId;var r;if(o==1){r="驾校统一安排训练时间（8：00到17:00）"}else if(o==2){r="自主预约练车（8:00到21:00）"}else if(o==3){r="一人一车每天至少1小时单练；自主预约练车（8:00到21:00）"}else if(o==4){r="一人一车每天至少1小时单练；自主预约练车（8:00到21:00）"}if(e.data.packetId==null){$(".rbox2").css({display:"block"});$(".rbox1").css({display:"none"})}else{$(".rbox2").css({display:"none"});$(".rbox1").css({display:"block"})}localStorage.orderNo=a;localStorage.price=t;localStorage.payPrice=s;localStorage.teachTime=r;localStorage.packetId=e.data.packetId;$("#price1").text(t);$("#allprice").text(s);$("#exetime1").text(r)},error:function(){alert("获取支付信息错误！")}})};$("#paybutton").click(function(){payMessage()});var payMessage=function(){location.href=baseUrl+"/view/pay"+"?orderNo="+localStorage.orderNo};$(".shareButton").click(function(){sharePacket()});var sharePacket=function(){$("#shareRedPacket").css({display:"block"});$(".savebutton").click(function(){var e=$("#sharePhone").val();if(reg.test(e)){var a={phone:e};$.ajax({method:"POST",url:baseUrl+"/business/addUser",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){var a="https://api.dobell.me/business/index.html?openId="+e.data.openId;$("#qrcodeCanvas").qrcode({render:"canvas",text:a,width:"125.5",height:"125.5",background:"#ffffff",foreground:"#000000",src:"./libs/images/logo.png"});function t(e){var a=new Image;a.src=e.toDataURL("image/png");return a}var s=document.getElementsByTagName("canvas")[0];var o=t(s);$("#cesi").append(o);$("#cesi").find("img").attr("id","cesiPic");var r=$("#cesi").find("img")[0].src;$("#cesi").ready(function(){mergeImages()});$(".fPic").find("img").attr("id","baocunImg");$(".noneButton").click(function(){$(".tipMessage").css({display:"none"})});$("#tegg").css({display:"block"});$("#closeImg").click(function(){window.location.reload()})},error:function(){alert("分享错误！")}})}else{$.toast.prototype.defaults.duration=1e3;$.toast("你输入的号码格式有误！","forbidden")}})};var myOrder=function(){$(".myorder").fadeIn("slow").css({display:"block"});$("#ordphone").blur(function(){var e=$("#ordphone").val();if(reg.test(e)){localStorage.orderPhoneNumber=e}else{$.toast.prototype.defaults.duration=1e3;$.toast("你输入的号码格式有误！","forbidden")}});$("#searchorder").click(function(){if(localStorage.orderPhoneNumber){var e={phone:localStorage.orderPhoneNumber};$.ajax({method:"POST",url:baseUrl+"/business/getOrderByPhone",async:true,cache:false,data:e,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){if(e.data){var a=e.data.tradeStatus;var t=e.data.orderNo;var s=e.data.price;var o=e.data.payPrice;var r=e.data.classId;var c;if(r==1){c="驾校统一安排训练时间（8：00到17:00）"}else if(r==2){c="自主预约练车（8:00到21:00）"}else if(r==3){c="一人一车每天至少1小时单练；自主预约练车（8:00到21:00）"}else if(r==4){c="一人一车每天至少1小时单练；自主预约练车（8:00到21:00）"}localStorage.orderNo=t;localStorage.price=s;localStorage.payPrice=o;localStorage.teachTime=c;localStorage.packetId=e.data.packetId;if(e.data.isDeleted==0&&a==1){if(e.data.packetId==null){$(".rbox2").css({display:"block"});$(".rbox1").css({display:"none"})}else{$(".rbox2").css({display:"none"});$(".rbox1").css({display:"block"})}$("#price1").text(s);$("#allprice").text(o);$("#exetime1").text(c);$(".myorder").css({display:"none"});$(".signUpSuccess").fadeIn("slow").css({display:"block"});$("#cancleorder").css({display:"block"});cancleOrder(e.data.id)}else if(e.data.isDeleted==0&&a==2){if(e.data.packetId==null){$(".rbox2").css({display:"block"});$(".rbox1").css({display:"none"})}else{$(".rbox2").css({display:"none"});$(".rbox1").css({display:"block"})}$("#price1").text(s);$("#allprice").text(o);$("#exetime1").text(c);$("#sucMessage").text("已支付");$(".myorder").css({display:"none"});$("#paybutton").css({display:"none"});$(".signUpSuccess").fadeIn("slow").css({display:"block"})}else{$.toast("未查到用户订单","cancel")}}else{$.toast("未查到用户订单","cancel")}},error:function(){alert("获取支付信息错误！")}})}else{$.toast.prototype.defaults.duration=1e3;$.toast("请输入手机号","cancel")}})};var cancleOrder=function(e){var a={id:e,isDeleted:1,tradeStatus:3};$("#cancleorder").click(function(){$.ajax({method:"POST",url:baseUrl+"/business/updateOrder",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){alert("成功取消订单");window.location.reload()},error:function(){alert("获取支付信息错误！")}})})};var shareRecord=function(){$("#sharerecord").css({display:"block"});$("#recordButton").click(function(){var e=$("#shrphone").val();var a={phone:e};if(reg.test(e)){$.ajax({method:"POST",url:baseUrl+"/business/addUser",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){var a=e.data.openId;lookforRecord(a)},error:function(){alert("获取支付信息错误！")}})}else{$.toast.prototype.defaults.duration=1e3;$.toast("你输入的号码格式有误！","forbidden")}})};var lookforRecord=function(e){var a={openId:e};$.ajax({method:"POST",url:baseUrl+"/business/getMyRecommendList",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){if(e.data.length>0){$("#sharerecord").css({display:"none"});$("#sharelist").css({display:"block"});var a;for(let t=0;t<e.data.length;t++){if(e.data[t].tradeStatus==1){a="未支付"}else if(e.data[t].tradeStatus==2){a="已支付"}else if(e.data[t].tradeStatus==3){a="已取消"}$("#record").append("<div class='weui-cell'>"+e.data[t].phone+"("+a+")"+"</div>")}}else{alert("暂无分享记录");window.location.reload()}},error:function(){alert("获取支付信息错误！")}})};var IdCodeValid=function(e){var a={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外 "};var t={pass:true,msg:"验证成功"};if(!e||!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|[xX])$/.test(e)){t={pass:false,msg:"身份证号格式错误"}}else if(!a[e.substr(0,2)]){t={pass:false,msg:"身份证号地址编码错误"}}else{if(e.length==18){e=e.split("");var s=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2];var o=[1,0,"X",9,8,7,6,5,4,3,2];var r=0;var c=0;var n=0;for(var l=0;l<17;l++){c=e[l];n=s[l];r+=c*n}if(o[r%11]!=e[17].toUpperCase()){t={pass:false,msg:"身份证号校验位错误"}}}}return t}}else{localStorage.clear();$(".box").click(function(){window.location.reload();window.location.reload()});$(".btn1").click(function(){signup()});var signup=function(){$(".signUp").fadeIn("slow").css({display:"block"});$.ajax({method:"GET",url:baseUrl+"/business/getClassList",async:true,cache:false,data:"",dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){const a=e.data[0].licenseType+" 手动 "+e.data[0].classType;const t=e.data[1].licenseType+" 手动 "+e.data[1].classType;const s=e.data[2].licenseType+" 手动 "+e.data[2].classType;const o=e.data[3].licenseType+" 自动 "+e.data[3].classType;$("#schclass1").text(a);$("#schclass2").text(t);$("#schclass3").text(s);$("#schclass4").text(o);var r=$("#select_id").find("option:selected").text();var c=$("#select_id").find("option:selected").val();$("#classmessage").text(r);$("#price").text(e.data[c].price);$("#exetime").text(e.data[c].teachTime);$("#select_id").change(function(){var a=$("#select_id").find("option:selected").text();var t=$("#select_id").find("option:selected").val();$("#classmessage").text(a);$("#price").text(e.data[t].price);$("#exetime").text(e.data[t].teachTime)})},error:function(){alert("加载失败")}});$("#phone").blur(function(){$("#select-redpack").empty();var e=$("#phone").val();if(reg.test(e)){var a={phone:e};$.ajax({method:"POST",url:baseUrl+"/business/getPacketList",async:false,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){localStorage.redpacklength=e.data.length;var a=[];for(let t=0;t<e.data.length;t++){a.push(e.data[t].id)}localStorage.localPacID=a.join(",")},error:function(){alert("获取红包数据错误！")}});if(localStorage.redpacklength>0){for(let e=0;e<localStorage.redpacklength;e++){$("#select-redpack").append("<option value="+(e+1)+">分享立减红包50元</option>")}}else{$("#select-redpack").append("<option value='0'>暂无红包信息</option>")}}else{$.toast.prototype.defaults.duration=1e3;$.toast("你输入的号码格式有误！","forbidden")}});$("#signUpBtn").click(function(){var e=$("#phone").val();var a=$("#realName").val();var t=$("#idCard").val();if(e&&a&&t){var s=parseInt($("#select_id").find("option:selected").val())+1;var o=e;var r;var c;var n=a;var l=t;if(sessionStorage.fromPhone){r=param.openId}else{r=""}if(parseInt($("#select-redpack").find("option:selected").val())==0){c=""}else{var i=parseInt($("#select-redpack").find("option:selected").val())-1;var d=localStorage.localPacID.split(",");c=parseInt(d[i])}if(IdCodeValid(l).pass==true){signUpMessage(s,o,r,c,n,l)}else{$.toast("身份证信息填写错误！","forbidden")}}else{$.toast("请完善报名信息！","forbidden")}})};var signUpMessage=function(e,a,t,s,o,r){var c={classId:e,phone:a,openId:t,packetId:s,realName:o,idCode:r};$.ajax({method:"POST",url:baseUrl+"/business/addOrder",async:true,cache:false,data:c,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){if(e.message==null){$(".signUp").css({display:"none"});$(".signUpSuccess").fadeIn("slow").css({display:"block"});getOrder(a)}else{alert(e.message)}},error:function(){alert("报名失败，请重试！")}})};var getOrder=function(e){var a={phone:e};$.ajax({method:"POST",url:baseUrl+"/business/getOrderByPhone",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){var a=e.data.orderNo;var t=e.data.price;var s=e.data.payPrice;var o=e.data.classId;var r;if(o==1){r="驾校统一安排训练时间（8：00到17:00）"}else if(o==2){r="自主预约练车（8:00到21:00）"}else if(o==3){r="一人一车每天至少1小时单练；自主预约练车（8:00到21:00）"}else if(o==4){r="一人一车每天至少1小时单练；自主预约练车（8:00到21:00）"}if(e.data.packetId==null){$(".rbox2").css({display:"block"});$(".rbox1").css({display:"none"})}else{$(".rbox2").css({display:"none"});$(".rbox1").css({display:"block"})}localStorage.orderNo=a;localStorage.price=t;localStorage.payPrice=s;localStorage.teachTime=r;localStorage.packetId=e.data.packetId;$("#price1").text(t);$("#allprice").text(s);$("#exetime1").text(r)},error:function(){alert("获取支付信息错误！")}})};$("#paybutton").click(function(){payMessage()});var payMessage=function(){location.href=baseUrl+"/view/pay"+"?orderNo="+localStorage.orderNo};$(".shareButton").click(function(){sharePacket()});var sharePacket=function(){$("#shareRedPacket").css({display:"block"});$(".savebutton").click(function(){var e=$("#sharePhone").val();if(reg.test(e)){var a={phone:e};$.ajax({method:"POST",url:baseUrl+"/business/addUser",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){var a="https://api.dobell.me/business/index.html?openId="+e.data.openId;$("#qrcodeCanvas").qrcode({render:"canvas",text:a,width:"125.5",height:"125.5",background:"#ffffff",foreground:"#000000",src:"./libs/images/logo.png"});function t(e){var a=new Image;a.src=e.toDataURL("image/png");return a}var s=document.getElementsByTagName("canvas")[0];var o=t(s);$("#cesi").append(o);$("#cesi").find("img").attr("id","cesiPic");var r=$("#cesi").find("img")[0].src;$("#cesi").ready(function(){mergeImages(r)});$(".fPic").find("img").attr("id","baocunImg");$(".noneButton").click(function(){$(".tipMessage").css({display:"none"})});$("#tegg").css({display:"block"});$("#closeImg").click(function(){window.location.reload()})},error:function(){alert("分享错误！")}})}else{$.toast.prototype.defaults.duration=1e3;$.toast("你输入的号码格式有误！","forbidden")}})};var myOrder=function(){$(".myorder").fadeIn("slow").css({display:"block"});$("#ordphone").blur(function(){var e=$("#ordphone").val();if(reg.test(e)){localStorage.orderPhoneNumber=e}else{$.toast.prototype.defaults.duration=1e3;$.toast("你输入的号码格式有误！","forbidden")}});$("#searchorder").click(function(){if(localStorage.orderPhoneNumber){var e={phone:localStorage.orderPhoneNumber};$.ajax({method:"POST",url:baseUrl+"/business/getOrderByPhone",async:true,cache:false,data:e,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){if(e.data){var a=e.data.tradeStatus;var t=e.data.orderNo;var s=e.data.price;var o=e.data.payPrice;var r=e.data.classId;var c;if(r==1){c="驾校统一安排训练时间（8：00到17:00）"}else if(r==2){c="自主预约练车（8:00到21:00）"}else if(r==3){c="一人一车每天至少1小时单练；自主预约练车（8:00到21:00）"}else if(r==4){c="一人一车每天至少1小时单练；自主预约练车（8:00到21:00）"}localStorage.orderNo=t;localStorage.price=s;localStorage.payPrice=o;localStorage.teachTime=c;localStorage.packetId=e.data.packetId;if(e.data.isDeleted==0&&a==1){if(e.data.packetId==null){$(".rbox2").css({display:"block"});$(".rbox1").css({display:"none"})}else{$(".rbox2").css({display:"none"});$(".rbox1").css({display:"block"})}$("#price1").text(s);$("#allprice").text(o);$("#exetime1").text(c);$(".myorder").css({display:"none"});$(".signUpSuccess").fadeIn("slow").css({display:"block"});$("#cancleorder").css({display:"block"});cancleOrder(e.data.id)}else if(e.data.isDeleted==0&&a==2){if(e.data.packetId==null){$(".rbox2").css({display:"block"});$(".rbox1").css({display:"none"})}else{$(".rbox2").css({display:"none"});$(".rbox1").css({display:"block"})}$("#price1").text(s);$("#allprice").text(o);$("#exetime1").text(c);$("#sucMessage").text("已支付");$(".myorder").css({display:"none"});$("#paybutton").css({display:"none"});$(".signUpSuccess").fadeIn("slow").css({display:"block"})}else{$.toast("未查到用户订单","cancel")}}else{$.toast("未查到用户订单","cancel")}},error:function(){alert("获取支付信息错误！")}})}else{$.toast.prototype.defaults.duration=1e3;$.toast("请输入手机号","cancel")}})};var cancleOrder=function(e){var a={id:e,isDeleted:1,tradeStatus:3};$("#cancleorder").click(function(){$.ajax({method:"POST",url:baseUrl+"/business/updateOrder",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){alert("成功取消订单");window.location.reload()},error:function(){alert("获取支付信息错误！")}})})};var shareRecord=function(){$("#sharerecord").css({display:"block"});$("#recordButton").click(function(){var e=$("#shrphone").val();var a={phone:e};if(reg.test(e)){$.ajax({method:"POST",url:baseUrl+"/business/addUser",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){var a=e.data.openId;lookforRecord(a)},error:function(){alert("获取支付信息错误！")}})}else{$.toast.prototype.defaults.duration=1e3;$.toast("你输入的号码格式有误！","forbidden")}})};var lookforRecord=function(e){var a={openId:e};$.ajax({method:"POST",url:baseUrl+"/business/getMyRecommendList",async:true,cache:false,data:a,dataType:"json",timeout:2e3,complete:function(e,a){if(a=="timeout"){ajaxTimeoutTest.abort();alert("请求超时")}},success:function(e){if(e.data.length>0){$("#sharerecord").css({display:"none"});$("#sharelist").css({display:"block"});var a;for(let t=0;t<e.data.length;t++){if(e.data[t].tradeStatus==1){a="未支付"}else if(e.data[t].tradeStatus==2){a="已支付"}else if(e.data[t].tradeStatus==3){a="已取消"}$("#record").append("<div class='weui-cell'>"+e.data[t].phone+"("+a+")"+"</div>")}}else{alert("暂无分享记录");window.location.reload()}},error:function(){alert("获取支付信息错误！")}})};var IdCodeValid=function(e){var a={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外 "};var t={pass:true,msg:"验证成功"};if(!e||!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|[xX])$/.test(e)){t={pass:false,msg:"身份证号格式错误"}}else if(!a[e.substr(0,2)]){t={pass:false,msg:"身份证号地址编码错误"}}else{if(e.length==18){e=e.split("");var s=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2];var o=[1,0,"X",9,8,7,6,5,4,3,2];var r=0;var c=0;var n=0;for(var l=0;l<17;l++){c=e[l];n=s[l];r+=c*n}if(o[r%11]!=e[17].toUpperCase()){t={pass:false,msg:"身份证号校验位错误"}}}}return t}}function mergeImages(){var e=document.getElementById("sharePIC");var a=document.getElementById("cesiPic");var t=$(".showPic").append('<canvas id="myCanvas"></canvas>');var s=$("#myCanvas")[0];s.width=375;s.height=603;var o=s.getContext("2d");o.drawImage(e,0,0,375,603);o.drawImage(a,124.75,395,125.5,125.5);function r(e){var a=new Image;a.crossOrigin="Anonymous";a.src=e.toDataURL("image/png");return a}var c=$("#myCanvas")[0];var n=r(c);$(".fPic").append(n)}